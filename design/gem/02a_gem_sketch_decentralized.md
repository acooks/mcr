# Sketch v2: Group Encrypted Multicast (GEM) - Decentralized Model

## 1. Problem Statement

Customers need to securely transport multicast traffic across untrusted networks (e.g., the public internet, corporate WANs) while preserving the original multicast addressing. The solution must be resilient, scalable, and avoid single points of failure.

## 2. High-Level Goal & Core Innovation

To create a secure, encrypted multicast network over an untrusted fabric **without** resorting to unicast encapsulation for the data plane. The system will be decentralized, with no single key server, and will use a combination of symmetric and asymmetric cryptography to manage identity, authorization, and data encryption.

## 3. The Two-Plane Architecture

GEM is architected as two distinct planes: a Control Plane for identity and authorization, and a Data Plane for secure packet transport.

### 3.1. The Control Plane: Identity, Discovery, and Authorization

This plane's purpose is to build a secure, shared understanding of who is in the group and who is allowed to do what.

*   **Component 1: Bootstrap Key (BK)**
    *   A symmetric, pre-shared key (e.g., from a YubiKey or file) that is manually configured on all MCR instances in a group.
    *   **Purpose:** To encrypt the initial peer discovery and public key exchange, establishing a root of trust.

*   **Component 2: Public/Private Keys**
    *   Each MCR instance has a long-term, unique public/private key pair (e.g., Ed25519).
    *   **Purpose:** To establish a persistent, verifiable identity for each peer. Public keys are exchanged during the bootstrap process.

*   **Component 3: Group Authorization Key (GAK)**
    *   A symmetric, pre-shared key that is manually configured only on MCR instances authorized to participate in a specific multicast group (e.g., `239.1.1.0/24`).
    *   **Purpose:**
        1.  **Policy:** Allows a receiver to quickly determine if it should process traffic for a given group.
        2.  **Authentication:** Used to sign/verify control messages related to the group, proving the sender is an authorized member.

### 3.2. The Data Plane: Source-Encrypted Multicast Transport

This plane's purpose is to securely encrypt and transmit the multicast data.

*   **Component 4: Source Encryption Key (SEK)**
    *   A symmetric, temporary key generated by a source MCR instance for a specific multicast stream it is originating.
    *   **Purpose:** To encrypt the payload of the data plane multicast packets for a single stream.

## 4. High-Level Workflow

1.  **Bootstrap:** When MCR instances start, they use the **BK** to encrypt "hello" messages sent to a discovery multicast address. These messages contain their **Public Keys**. Over time, all peers securely build a complete map of each other's identities.

2.  **SEK Distribution:**
    *   A source (`MCR-A`) wants to send a stream to `239.1.1.1`. It generates a new **SEK**.
    *   `MCR-A` creates a plaintext control message: `[My Identity] + [Target Group: 239.1.1.1] + [My SEK]`.
    *   It signs this message with the **GAK** for the `239.1.1.0/24` group.
    *   It sends the `[Plaintext Message] + [Signature]` to a control-plane multicast address.
    *   Receiving peers (`MCR-B`) use their copy of the **GAK** to verify the signature. If valid, they store the **SEK** and associate it with `MCR-A`.

3.  **Data Transport:**
    *   `MCR-A` encrypts the payload of its multicast packets for `239.1.1.1` using the **SEK**.
    *   It sends these encrypted packets to the `239.1.1.1` multicast group. The IP headers remain multicast.
    *   `MCR-B` receives the encrypted multicast packets. It looks up the correct **SEK** based on the source (`MCR-A`) and destination group, decrypts the payload, and forwards the original data to its local network.

---
